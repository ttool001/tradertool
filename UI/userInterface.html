<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial=scale=1" name="viewport">
    <title>Sentiment Analysis</title><!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Latest compiled and minified CSS -->
    <link href=
    "http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel=
    "stylesheet"><!-- jQuery library -->

    <script src=
    "https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js">
    </script><!-- Latest compiled JavaScript -->

    <script src=
    "http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js">
    </script>
    <link href="my_style.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Berkshire+Swash' rel=
    'stylesheet' type='text/css'>
    <script src=
    "http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js">
    </script>
    <script src="http://code.highcharts.com/highcharts.js">
    </script>
</head>
<body>
    <!-- Modal -->
    <div class="modal fader" id="myModal" role="dialog">
        <div class="modal-dialog modal-lg">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal" type=
                    "button">&times;</button>
                    <h4 class="modal-title">Stock Analytics for $<label id=
                    "selected_ticker"></label></h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-sm-6">
                            <div id="container_line_chart" style=
                            "width: 425px; height: 350px; margin: 0 auto">
                            </div>
                            <script src="line_chart.js" type="text/javascript">
                            </script>
                        </div>
                        <div class="col-sm-offset-6">
                            <div id="container_bar_chart" style=
                            "width: 425px; height: 350px; margin: 0 auto">
                            </div>
                            <script src="bar_chart.js" type="text/javascript">
                            </script>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-default" data-dismiss="modal" type=
                    "button">Close</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
                var table_start='<table class="table table-bordered table-hover specialCollapse">';
                var table_header='<thead class="thead-inverse"><tr><th class="col-md-6"><small>Ticker<\/small><\/th><th class="col-md-6"><small>Sentiment<\/small><\/th><\/tr><\/thead>';
                var table_body_start='<tbody>';
                var table_row_start='<tr class="clickable-row">';
                var cell_start='<td class="col-md-6"><small>';
                var cell_end='<\/small><\/td>';
                var table_row_end='<\/tr>';
                var table_body_end='<\/tbody>';
                var table_end='<\/table>';

                function topFiveExtremeTickers(endpoint) {
                    var pos_list = new Array();
                    var neg_list = new Array();
                
                    $.get(endpoint, function(result) {
                        $.each(result['pos_list'], function(index, value) {
                            pos_list.push(this['ticker']);
                            pos_list.push(this['senti']);
                        });
                        $.each(result['neg_list'], function(index, value) {
                            neg_list.push(this['ticker']);
                            neg_list.push(this['senti']);
                        });
                        
                        var table_creation_start_pos=table_start+table_header+table_body_start;
                        var table_creation_start_neg=table_start+table_header+table_body_start;
                        for(var i=0; i<10; i=i+2){
                            table_creation_start_pos += table_row_start+cell_start+pos_list[i]+cell_end+cell_start+pos_list[i+1]+cell_end+table_row_end;
                        }
                        for(var i=0; i<10; i=i+2){
                            table_creation_start_neg += table_row_start+cell_start+neg_list[i]+cell_end+cell_start+neg_list[i+1]+cell_end+table_row_end;
                        }
                        // alert(table_creation_start+table_body_end+table_end);
                        $('#table_positive').append(table_creation_start_pos+table_body_end+table_end);
                        $('#table_negative').append(table_creation_start_neg+table_body_end+table_end);

                    });
                }
            
    </script>
    <header class="navbar-default" role="banner">
        <div class="container">
            <div class="page-header">
                <h1 class="text-center">Stock Sentiment Analysis</h1>
            </div>
        </div>
        <nav role="navigation">
            <div class="container-fluid">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button aria-expanded="false" class=
                    "navbar-toggle collapsed" data-target=
                    "#bs-example-navbar-collapse-1" data-toggle="collapse"
                    type="button"><span class="sr-only">Toggle
                    navigation</span> <span class="icon-bar"></span>
                    <span class="icon-bar"></span> <span class=
                    "icon-bar"></span></button>
                </div>
                <form class="navbar-form navbar-left" role="search">
                    <div class="form-group">
                        <input class="form-control" id="search" placeholder=
                        "Search" type="text"> <button class="btn btn-info"
                        data-target="#myModal" data-toggle="modal" id=
                        "search_button" type="button">Get Analytics</button>
                    </div>
                </form>
            </div><!-- /.container-fluid -->
        </nav>
    </header><br>
    <div class="container">
        <div class="row">
            <div class="col-sm-6">
                <div class="panel panel-success">
                    <div class="panel-heading">
                        <h3 class="panel-title">You want to buy these
                        :)</h3><span class="pull-right clickable"><i class=
                        "glyphicon glyphicon-chevron-up"></i></span>
                    </div>
                    <div class="panel-body">
                        <div id="table_positive"></div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="panel panel-danger">
                    <div class="panel-heading">
                        <h3 class="panel-title">You want to dump these
                        :(</h3><span class="pull-right clickable"><i class=
                        "glyphicon glyphicon-chevron-up"></i></span>
                    </div>
                    <div class="panel-body">
                        <div id="table_negative"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function(){
             $(".clickable-row").click(function() {
                window.document.location = $(this).data("href");
            });
             $("button").click(function(){
                // alert($("#search").val());
                $('#selected_ticker').html($("#search").val());
             })

             
            topFiveExtremeTickers('http://python-jphackathon.rhcloud.com/getlists/');
            // topFiveExtremeTickers('http://python-jphackathon.rhcloud.com/getlists/', 'neg_list', '#table_negative');
        });
    </script> 
    <script type="text/javascript">
            $(document).on('click', '.panel-heading span.clickable', function(e){
                var $this = $(this);
                if(!$this.hasClass('panel-collapsed')) {
                    $this.parents('.panel').find('.specialCollapse').slideUp();
                    $this.addClass('panel-collapsed');
                    $this.find('i').removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');
                } else {
                    $this.parents('.panel').find('.specialCollapse').slideDown();
                    $this.removeClass('panel-collapsed');
                    $this.find('i').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');
                }
            })
    </script>
</body>
</html>